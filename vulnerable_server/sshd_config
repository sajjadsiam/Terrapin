# Vulnerable SSH Server Configuration for Terrapin Attack Demo
# DO NOT USE IN PRODUCTION

# Port and listening
Port 22
ListenAddress 0.0.0.0

# Host keys
HostKey /etc/ssh/ssh_host_rsa_key
HostKey /etc/ssh/ssh_host_ecdsa_key
HostKey /etc/ssh/ssh_host_ed25519_key

# Security settings (intentionally weak for demo)
PermitRootLogin yes
PasswordAuthentication yes
PermitEmptyPasswords no
ChallengeResponseAuthentication no

# Enable vulnerable ciphers
# These are the ciphers vulnerable to Terrapin attack
Ciphers chacha20-poly1305@openssh.com,aes256-cbc,aes192-cbc,aes128-cbc,aes256-ctr,aes192-ctr,aes128-ctr

# Key exchange algorithms
KexAlgorithms curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchange-sha256,diffie-hellman-group14-sha256

# MACs (include encrypt-then-mac variants)
MACs hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1

# Host key algorithms
HostKeyAlgorithms ssh-ed25519,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,ssh-rsa,rsa-sha2-256,rsa-sha2-512

# Logging
SyslogFacility AUTH
LogLevel VERBOSE

# Authentication
UsePAM yes
MaxAuthTries 3
MaxSessions 10

# Subsystems
Subsystem sftp /usr/lib/openssh/sftp-server

# Disable strict mode for demo purposes
StrictModes no

# X11 Forwarding
X11Forwarding yes
X11DisplayOffset 10

# Print MOTD
PrintMotd yes
PrintLastLog yes

# Accept environment variables
AcceptEnv LANG LC_*

# Allow TCP forwarding (for demo purposes)
AllowTcpForwarding yes
GatewayPorts no

# Client alive settings
ClientAliveInterval 60
ClientAliveCountMax 3
